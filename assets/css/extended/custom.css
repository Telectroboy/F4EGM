/* ==========================================
   FOND GLOBAL (toujours visible)
   ========================================== */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background-image: url(/images/fondF4EGM.png);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    z-index: -2; /* sous tout */
    filter: brightness(.55) contrast(1.1);
}

/* ==========================================
   OVERLAY SUR LA ZONE D'ÉCRITURE + MENU
   ========================================== */
body .main::before,
body .nav::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 12px;
    z-index: -1; /* entre fond et texte */
    backdrop-filter: blur(6px);
    transition: background-color 0.3s ease, -webkit-mask-image 0.3s ease;
    
    /* BORDS DÉGRADÉS pour transition douce 
    -webkit-mask-image: radial-gradient(circle at center, rgba(0,0,0,1) 90%, rgba(0,0,0,0) 100%);
    mask-image: radial-gradient(circle at center, rgba(0,0,0,1) 90%, rgba(0,0,0,0) 100%);
    mask-repeat: no-repeat;
    mask-position: center;
    mask-size: cover;
}*/
    /* Masque dégradé sur tous les bords */
    -webkit-mask-image: 
        linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0));
    -webkit-mask-composite: destination-in;
    mask-image: 
        linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0));
    mask-composite: intersect;

    /* Combinaison pour haut/bas */
    -webkit-mask-image: 
        linear-gradient(to top, rgba(0,0,0,0), rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0)),
        linear-gradient(to left, rgba(0,0,0,0), rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0));
    -webkit-mask-composite: destination-in;
    mask-image: 
        linear-gradient(to top, rgba(0,0,0,0), rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0)),
        linear-gradient(to left, rgba(0,0,0,0), rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0));
    mask-composite: intersect;
}

/* ==========================================
   LIGHT MODE
   ========================================== */
html[data-theme="light"] body .main::before,
html[data-theme="light"] body .nav::before {
    background-color: rgba(255,255,255,0.6); /* même luminosité */
}

/* ==========================================
   DARK MODE
   ========================================== */
html[data-theme="dark"] body .main::before,
html[data-theme="dark"] body .nav::before {
    background-color: rgba(0,0,0,0.5); /* même luminosité */
}

/* ==========================================
   POSITIONNEMENT RELATIF DES ZONES
   ========================================== */
body .main,
body .nav {
    position: relative;
    z-index: 0;
    border-radius: 10px;
    padding: 2rem;
    background: transparent; /* l’overlay ::before gère le flou / couleur */
}

/* ==========================================
   TEXTE
   ========================================== */
body .main,
body .nav,
body .main * {
    color: var(--primary); /* ou définir selon thème */
}

/****************************************************************************************/
/* ====== LAYOUT "Korben-like" : hero + grid responsive ====== */

/* 1) Largeur desktop */
.main {
  max-width: 1400px;
}

/* IMPORTANT : on ne met la grille QUE sur les pages listes.
   PaperMod ajoute souvent .list sur body/html selon pages.
   On cible plusieurs cas sûrs sans casser les pages single. */
body.list main.main,
body.home main.main,
body main.main:has(> article.post-entry) {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 22px;
  align-items: stretch;
}

/* Le hero en pleine largeur */
body.list main.main > article.first-entry,
body.home main.main > article.first-entry,
body main.main:has(> article.post-entry) > article.first-entry {
  grid-column: 1 / -1;
}

/* Empêcher le cover du hero d'exploser */
body.list .first-entry .entry-cover img,
body.home .first-entry .entry-cover img {
  width: 100%;
  height: 320px;
  object-fit: cover;
  display: block;
}

/* Cartes (hors hero) */
body.list main.main > article.post-entry,
body.home main.main > article.post-entry,
body main.main:has(> article.post-entry) > article.post-entry {
  margin: 0 !important;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 10px 26px rgba(0,0,0,0.10);
  transition: transform .15s ease, box-shadow .15s ease;
}

body.list main.main > article.post-entry:hover,
body.home main.main > article.post-entry:hover,
body main.main:has(> article.post-entry) > article.post-entry:hover {
  transform: translateY(-4px);
  box-shadow: 0 14px 34px rgba(0,0,0,0.14);
}

/* Covers des cartes */
body.list main.main > article.post-entry .entry-cover img,
body.home main.main > article.post-entry .entry-cover img,
body main.main:has(> article.post-entry) > article.post-entry .entry-cover img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  display: block;
}

/* Clamp de l'extrait */
body.list main.main > article.post-entry .entry-content,
body.home main.main > article.post-entry .entry-content,
body main.main:has(> article.post-entry) > article.post-entry .entry-content {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  opacity: 0.9;
}

/* Responsive */
@media (max-width: 1200px) {
  body.list main.main,
  body.home main.main,
  body main.main:has(> article.post-entry) {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
  body.list .first-entry .entry-cover img,
  body.home .first-entry .entry-cover img { height: 280px; }
}

@media (max-width: 720px) {
  body.list main.main,
  body.home main.main,
  body main.main:has(> article.post-entry) {
    grid-template-columns: 1fr;
  }
  body.list .first-entry .entry-cover img,
  body.home .first-entry .entry-cover img { height: 220px; }
}
